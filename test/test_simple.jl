using LinearAlgebra 

include(joinpath(@__DIR__, "../src/main.jl")) 


function test_simple(n_nodes, n_vehicles; n_iterations=10000, time_limit=4.0)

    coordinates = rand(n_nodes, 2) .* 10

    dist_mtx = zeros(n_nodes, n_nodes)
    for i=1:n_nodes
        for j=1:n_nodes
            dist_mtx[i, j] = norm(coordinates[i, :] - coordinates[j, :])
        end
    end



    dd = [[   0.  ,  258.72,  823.04,  417.29,  664.02,  526.03,  644.06,
         574.37,  616.02,  192.44],
       [ 258.72,    0.  , 1009.86,  419.67,  758.83,  624.72,  753.46,
         812.58,  773.15,  450.5 ],
       [ 823.04, 1009.86,    0.  ,  696.85,  401.73,  455.61,  366.33,
         893.78,  254.7 ,  732.85],
       [ 417.29,  419.67,  696.85,    0.  ,  360.49,  246.91,  367.91,
         918.38,  442.16,  525.24],
       [ 664.02,  758.83,  401.73,  360.49,    0.  ,  138.9 ,   45.03,
         991.52,  194.38,  674.54],
       [ 526.03,  624.72,  455.61,  246.91,  138.9 ,    0.  ,  128.82,
         889.03,  203.76,  548.64],
       [ 644.06,  753.46,  366.33,  367.91,   45.03,  128.82,    0.  ,
         952.05,  149.61,  643.74],
       [ 574.37,  812.58,  893.78,  918.38,  991.52,  889.03,  952.05,
           0.  ,  836.54,  401.23],
       [ 616.02,  773.15,  254.7 ,  442.16,  194.38,  203.76,  149.61,
         836.54,    0.  ,  572.16],
       [ 192.44,  450.5 ,  732.85,  525.24,  674.54,  548.64,  643.74,
         401.23,  572.16,    0.  ]]
    dist_mtx = hcat(dd...)' |> Matrix

    
    x = [382.56689776, 124.5875941 , 866.14750382, 227.41418686,
       464.48309819, 433.36472507, 501.30506347, 910.30607067,
       633.34193431, 574.89545149]
    y = [244.08118451, 224.57917736, 910.07201838, 631.45767299,
       903.02749121, 767.65655719, 877.10289439,  17.38521931,
       806.75055032, 237.58612663]
    coordinates = hcat(x, y)

    hgs_routes, hgs_route_lengths = solve_mTSP(n_vehicles, dist_mtx, coordinates; n_iterations=n_iterations, time_limit=time_limit)

end

# @time test_simple(10, 2)

# @time test_simple(10, 1)

@time test_simple(10, 3)